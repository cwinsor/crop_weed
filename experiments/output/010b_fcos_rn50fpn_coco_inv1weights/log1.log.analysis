(pytorch_d_1_13_1_cuda_11_7) $  cd /mnt/d/code_crop_weed/crop_weed ; /usr/bin/env /home/chris/anaconda3/envs/pytorch_d_1_13_1_cuda_11_7/bin/python /home/chris/.vscode-server/extensions/ms-python.python-2022.20.2/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher 50769 -- /home/chris/anaconda3/envs/pytorch_d_1_13_1_cuda_11_7/bin/torchrun --nproc_per_node 2 experiments/detection/train_001.py --output_dir experiments/output/010b_fcos_rn50fpn_coco_inv1weights --dataset coco --model fcos_resnet50_fpn --epochs 1 --weights-backbone IMAGENET1K_V1 --lr-steps 16 22 --aspect-ratio-group-factor 3 
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
| distributed init (rank 1): env://| distributed init (rank 0): env://

Namespace(
data_path='/mnt/d/dataset_coco_cocoapi/cocoapi/coco/', 
dataset='coco', 
model='fcos_resnet50_fpn', 
device='cuda', 
batch_size=2,  <-------------
epochs=1, 
workers=4,     <-------------
opt='sgd', 
lr=0.02, 
momentum=0.9, 
weight_decay=0.0001, 
norm_weight_decay=None, 
lr_scheduler='multisteplr', 
lr_step_size=8, 
lr_steps=[16, 22], 
lr_gamma=0.1, 
print_freq=20, 
output_dir='experiments/output/010b_fcos_rn50fpn_coco_inv1weights', 
resume='',       <------------
start_epoch=0,   <------------ 
aspect_ratio_group_factor=3, 
rpn_score_thresh=None, 
trainable_backbone_layers=None,  <--------------------------------------
data_augmentation='hflip',  <--------------
sync_bn=False, 
test_only=False,   <------------- 
use_deterministic_algorithms=False, 
world_size=2, 
dist_url='env://', 
weights=None,                      <------------------ 
weights_backbone='IMAGENET1K_V1',  <------------------
amp=False, 
use_copypaste=False, 
rank=0, 
gpu=0, 
distributed=True, 
dist_backend='nccl')



Loading data
loading annotations into memory...
Done (t=8.74s)
creating index...
index created!
loading annotations into memory...
Done (t=0.32s)
creating index...
index created!
Creating data loaders
Using [0, 0.5, 0.6299605249474366, 0.7937005259840997, 1.0, 1.2599210498948732, 1.5874010519681994, 2.0, inf] as bins for aspect ratio quantization
Count of instances per bin: [  104   982 24236  2332  8225 74466  5763  1158]
Creating model
Start training
Epoch: [0]  [    0/29316]  eta: 17:01:23  lr: 0.000040  loss: 2.8628 (2.8628)  bbox_ctrness: 0.6847 (0.6847)  bbox_regression: 1.0079 (1.0079)  classification: 1.1703 (1.1703)  time: 2.0905  data: 0.2468  max mem: 2073
Epoch: [0]  [   20/29316]  eta: 3:55:17  lr: 0.000440  loss: 2.8375 (2.8064)  bbox_ctrness: 0.6779 (0.6836)  bbox_regression: 0.9885 (0.9719)  classification: 1.1602 (1.1509)  time: 0.4015  data: 0.0104  max mem: 2447
Epoch: [0]  [   40/29316]  eta: 3:35:57  lr: 0.000839  loss: 2.4397 (2.6275)  bbox_ctrness: 0.6747 (0.6799)  bbox_regression: 0.6652 (0.8260)  classification: 1.0914 (1.1215)  time: 0.4013  data: 0.0084  max mem: 2532
Epoch: [0]  [   60/29316]  eta: 3:29:27  lr: 0.001239  loss: 2.2869 (2.5237)  bbox_ctrness: 0.6783 (0.6792)  bbox_regression: 0.6100 (0.7581)  classification: 1.0231 (1.0863)  time: 0.4028  data: 0.0084  max mem: 2532
Epoch: [0]  [   80/29316]  eta: 3:25:45  lr: 0.001638  loss: 2.2170 (2.4435)  bbox_ctrness: 0.6670 (0.6761)  bbox_regression: 0.5831 (0.7137)  classification: 0.9434 (1.0537)  time: 0.4001  data: 0.0090  max mem: 2532
Epoch: [0]  [  100/29316]  eta: 3:23:43  lr: 0.002038  loss: 2.1375 (2.3834)  bbox_ctrness: 0.6695 (0.6749)  bbox_regression: 0.5782 (0.6883)  classification: 0.8879 (1.0201)  time: 0.4026  data: 0.0093  max mem: 2532
Epoch: [0]  [  120/29316]  eta: 3:22:23  lr: 0.002438  loss: 2.1698 (2.3484)  bbox_ctrness: 0.6722 (0.6745)  bbox_regression: 0.5822 (0.6738)  classification: 0.8994 (1.0001)  time: 0.4036  data: 0.0090  max mem: 2532
Epoch: [0]  [  140/29316]  eta: 3:21:19  lr: 0.002837  loss: 2.0784 (2.3126)  bbox_ctrness: 0.6604 (0.6734)  bbox_regression: 0.5373 (0.6556)  classification: 0.8576 (0.9835)  time: 0.4024  data: 0.0085  max mem: 2532
Epoch: [0]  [  160/29316]  eta: 3:20:42  lr: 0.003237  loss: 2.1818 (2.2983)  bbox_ctrness: 0.6672 (0.6725)  bbox_regression: 0.5406 (0.6422)  classification: 0.9923 (0.9836)  time: 0.4061  data: 0.0087  max mem: 2532
Epoch: [0]  [  180/29316]  eta: 3:19:50  lr: 0.003636  loss: 2.1049 (2.2737)  bbox_ctrness: 0.6744 (0.6727)  bbox_regression: 0.5266 (0.6293)  classification: 0.8970 (0.9717)  time: 0.3996  data: 0.0096  max mem: 2532
Epoch: [0]  [  200/29316]  eta: 3:19:19  lr: 0.004036  loss: 2.1015 (2.2543)  bbox_ctrness: 0.6669 (0.6725)  bbox_regression: 0.5307 (0.6190)  classification: 0.9215 (0.9629)  time: 0.4036  data: 0.0092  max mem: 2532
Epoch: [0]  [  220/29316]  eta: 3:18:58  lr: 0.004436  loss: 2.0329 (2.2361)  bbox_ctrness: 0.6659 (0.6721)  bbox_regression: 0.5096 (0.6100)  classification: 0.8603 (0.9540)  time: 0.4059  data: 0.0091  max mem: 2532
Epoch: [0]  [  240/29316]  eta: 3:18:34  lr: 0.004835  loss: 2.2547 (2.2385)  bbox_ctrness: 0.6756 (0.6729)  bbox_regression: 0.5120 (0.6037)  classification: 1.0647 (0.9620)  time: 0.4037  data: 0.0093  max mem: 2532
Epoch: [0]  [  260/29316]  eta: 3:18:24  lr: 0.005235  loss: 2.1563 (2.2297)  bbox_ctrness: 0.6885 (0.6741)  bbox_regression: 0.5078 (0.5970)  classification: 0.9263 (0.9586)  time: 0.4090  data: 0.0091  max mem: 2544
Epoch: [0]  [  280/29316]  eta: 3:18:00  lr: 0.005634  loss: 2.1222 (2.2227)  bbox_ctrness: 0.6835 (0.6757)  bbox_regression: 0.5175 (0.5910)  classification: 0.9196 (0.9559)  time: 0.4023  data: 0.0087  max mem: 2544
Epoch: [0]  [  300/29316]  eta: 3:17:40  lr: 0.006034  loss: 2.0620 (2.2138)  bbox_ctrness: 0.6836 (0.6762)  bbox_regression: 0.5324 (0.5868)  classification: 0.8676 (0.9508)  time: 0.4029  data: 0.0088  max mem: 2544
Epoch: [0]  [  320/29316]  eta: 3:17:17  lr: 0.006434  loss: 2.0324 (2.2006)  bbox_ctrness: 0.6679 (0.6759)  bbox_regression: 0.5300 (0.5834)  classification: 0.8074 (0.9412)  time: 0.4004  data: 0.0087  max mem: 2544
Epoch: [0]  [  340/29316]  eta: 3:17:02  lr: 0.006833  loss: 1.9863 (2.1873)  bbox_ctrness: 0.6780 (0.6762)  bbox_regression: 0.4710 (0.5774)  classification: 0.8132 (0.9336)  time: 0.4041  data: 0.0096  max mem: 2544
Epoch: [0]  [  360/29316]  eta: 3:16:50  lr: 0.007233  loss: 1.9269 (2.1750)  bbox_ctrness: 0.6759 (0.6765)  bbox_regression: 0.5075 (0.5735)  classification: 0.7540 (0.9250)  time: 0.4056  data: 0.0089  max mem: 2544
Epoch: [0]  [  380/29316]  eta: 3:16:33  lr: 0.007632  loss: 1.8683 (2.1608)  bbox_ctrness: 0.6565 (0.6756)  bbox_regression: 0.4504 (0.5672)  classification: 0.7597 (0.9181)  time: 0.4024  data: 0.0086  max mem: 2544
Epoch: [0]  [  400/29316]  eta: 3:16:23  lr: 0.008032  loss: 1.9457 (2.1493)  bbox_ctrness: 0.6576 (0.6748)  bbox_regression: 0.4729 (0.5626)  classification: 0.8232 (0.9119)  time: 0.4063  data: 0.0090  max mem: 2544
Epoch: [0]  [  420/29316]  eta: 3:16:17  lr: 0.008432  loss: 2.0697 (2.1459)  bbox_ctrness: 0.6697 (0.6748)  bbox_regression: 0.4945 (0.5597)  classification: 0.9139 (0.9114)  time: 0.4093  data: 0.0088  max mem: 2544
Epoch: [0]  [  440/29316]  eta: 3:16:08  lr: 0.008831  loss: 1.9476 (2.1379)  bbox_ctrness: 0.6647 (0.6744)  bbox_regression: 0.4863 (0.5563)  classification: 0.8097 (0.9071)  time: 0.4066  data: 0.0089  max mem: 2544
Epoch: [0]  [  460/29316]  eta: 3:16:01  lr: 0.009231  loss: 2.1059 (2.1419)  bbox_ctrness: 0.6672 (0.6741)  bbox_regression: 0.5050 (0.5536)  classification: 0.9295 (0.9143)  time: 0.4086  data: 0.0087  max mem: 2544
Epoch: [0]  [  480/29316]  eta: 3:15:50  lr: 0.009630  loss: 3.1465 (2.2070)  bbox_ctrness: 0.6732 (0.6742)  bbox_regression: 0.5652 (0.5541)  classification: 1.8771 (0.9788)  time: 0.4051  data: 0.0085  max mem: 2544
Epoch: [0]  [  500/29316]  eta: 3:15:32  lr: 0.010030  loss: 3.0374 (2.2609)  bbox_ctrness: 0.6792 (0.6749)  bbox_regression: 0.5691 (0.5553)  classification: 1.7571 (1.0307)  time: 0.3994  data: 0.0090  max mem: 2544
Epoch: [0]  [  520/29316]  eta: 3:15:23  lr: 0.010430  loss: 11.8659 (2.7188)  bbox_ctrness: 0.6787 (0.6750)  bbox_regression: 0.5782 (0.5567)  classification: 10.5467 (1.4871)  time: 0.4059  data: 0.0099  max mem: 2544
Epoch: [0]  [  540/29316]  eta: 3:15:14  lr: 0.010829  loss: 8.4238 (3.3988)  bbox_ctrness: 0.6675 (0.6749)  bbox_regression: 0.5780 (0.5568)  classification: 7.2707 (2.1670)  time: 0.4062  data: 0.0089  max mem: 2544
Epoch: [0]  [  560/29316]  eta: 3:15:03  lr: 0.011229  loss: 1145.6780 (500.1454)  bbox_ctrness: 0.6676 (0.6749)  bbox_regression: 0.5700 (0.5574)  classification: 1144.4729 (498.9131)  time: 0.4044  data: 0.0093  max mem: 2544
Epoch: [0]  [  580/29316]  eta: 3:14:47  lr: 0.011628  loss: 6643.6777 (1190.4319)  bbox_ctrness: 0.6907 (0.6758)  bbox_regression: 0.5650 (0.5576)  classification: 6642.4375 (1189.1986)  time: 0.3991  data: 0.0095  max mem: 2544
Epoch: [0]  [  600/29316]  eta: 3:14:28  lr: 0.012028  loss: 33.6143 (1155.1816)  bbox_ctrness: 0.7206 (0.6772)  bbox_regression: 0.5861 (0.5581)  classification: 32.4909 (1153.9464)  time: 0.3951  data: 0.0090  max mem: 2544
Epoch: [0]  [  620/29316]  eta: 3:14:17  lr: 0.012428  loss: 6.1935 (1118.2103)  bbox_ctrness: 0.6782 (0.6773)  bbox_regression: 0.5517 (0.5583)  classification: 5.0460 (1116.9747)  time: 0.4038  data: 0.0092  max mem: 2544
Epoch: [0]  [  640/29316]  eta: 3:14:08  lr: 0.012827  loss: 7.8136 (1083.5730)  bbox_ctrness: 0.6748 (0.6772)  bbox_regression: 0.5612 (0.5586)  classification: 6.5289 (1082.3373)  time: 0.4055  data: 0.0089  max mem: 2544
Epoch: [0]  [  660/29316]  eta: 3:13:59  lr: 0.013227  loss: 6.1101 (1050.9877)  bbox_ctrness: 0.6671 (0.6769)  bbox_regression: 0.5650 (0.5587)  classification: 4.9087 (1049.7521)  time: 0.4047  data: 0.0093  max mem: 2544
Epoch: [0]  [  680/29316]  eta: 3:13:47  lr: 0.013626  loss: 6.5677 (1020.3335)  bbox_ctrness: 0.6704 (0.6768)  bbox_regression: 0.5571 (0.5587)  classification: 5.3691 (1019.0980)  time: 0.4014  data: 0.0094  max mem: 2544
Epoch: [0]  [  700/29316]  eta: 3:13:35  lr: 0.014026  loss: 6.2936 (991.4181)  bbox_ctrness: 0.6683 (0.6767)  bbox_regression: 0.5631 (0.5587)  classification: 5.0549 (990.1826)  time: 0.4010  data: 0.0086  max mem: 2544
Epoch: [0]  [  720/29316]  eta: 3:13:25  lr: 0.014426  loss: 6.0861 (964.0990)  bbox_ctrness: 0.6692 (0.6766)  bbox_regression: 0.5467 (0.5587)  classification: 4.7633 (962.8637)  time: 0.4035  data: 0.0087  max mem: 2544
Epoch: [0]  [  740/29316]  eta: 3:13:12  lr: 0.014825  loss: 6.9065 (938.2616)  bbox_ctrness: 0.6845 (0.6768)  bbox_regression: 0.5239 (0.5579)  classification: 5.6587 (937.0269)  time: 0.4007  data: 0.0096  max mem: 2544
Epoch: [0]  [  760/29316]  eta: 3:12:59  lr: 0.015225  loss: 6.8127 (913.7919)  bbox_ctrness: 0.6728 (0.6767)  bbox_regression: 0.5609 (0.5583)  classification: 5.6041 (912.5569)  time: 0.3989  data: 0.0092  max mem: 2544
Epoch: [0]  [  780/29316]  eta: 3:12:52  lr: 0.015624  loss: 5.6489 (890.5476)  bbox_ctrness: 0.6668 (0.6765)  bbox_regression: 0.5594 (0.5585)  classification: 4.4329 (889.3126)  time: 0.4060  data: 0.0090  max mem: 2544
Epoch: [0]  [  800/29316]  eta: 3:12:40  lr: 0.016024  loss: 5.7735 (868.4675)  bbox_ctrness: 0.6758 (0.6765)  bbox_regression: 0.5520 (0.5583)  classification: 4.5527 (867.2328)  time: 0.4008  data: 0.0091  max mem: 2544
Epoch: [0]  [  820/29316]  eta: 3:12:29  lr: 0.016424  loss: 6.1804 (847.4691)  bbox_ctrness: 0.6978 (0.6771)  bbox_regression: 0.5687 (0.5586)  classification: 4.9041 (846.2334)  time: 0.4011  data: 0.0089  max mem: 2544
Epoch: [0]  [  840/29316]  eta: 3:12:19  lr: 0.016823  loss: 6.3949 (827.4863)  bbox_ctrness: 0.6718 (0.6770)  bbox_regression: 0.5571 (0.5583)  classification: 5.1593 (826.2510)  time: 0.4030  data: 0.0087  max mem: 2544
Epoch: [0]  [  860/29316]  eta: 3:12:13  lr: 0.017223  loss: 6.8106 (808.4320)  bbox_ctrness: 0.6673 (0.6767)  bbox_regression: 0.5416 (0.5578)  classification: 5.6736 (807.1976)  time: 0.4075  data: 0.0087  max mem: 2544
Epoch: [0]  [  880/29316]  eta: 3:12:01  lr: 0.017622  loss: 5.6243 (790.2152)  bbox_ctrness: 0.6706 (0.6766)  bbox_regression: 0.5321 (0.5574)  classification: 4.3592 (788.9813)  time: 0.3992  data: 0.0087  max mem: 2544
Epoch: [0]  [  900/29316]  eta: 3:11:51  lr: 0.018022  loss: 6.0721 (772.8269)  bbox_ctrness: 0.6633 (0.6763)  bbox_regression: 0.5435 (0.5574)  classification: 4.8664 (771.5931)  time: 0.4026  data: 0.0091  max mem: 2544
Epoch: [0]  [  920/29316]  eta: 3:11:40  lr: 0.018422  loss: 6.3416 (756.2008)  bbox_ctrness: 0.6692 (0.6764)  bbox_regression: 0.5387 (0.5570)  classification: 5.1003 (754.9674)  time: 0.4010  data: 0.0089  max mem: 2544
Epoch: [0]  [  940/29316]  eta: 3:11:33  lr: 0.018821  loss: 6.4114 (740.2748)  bbox_ctrness: 0.6882 (0.6768)  bbox_regression: 0.5834 (0.5576)  classification: 5.1314 (739.0404)  time: 0.4071  data: 0.0091  max mem: 2544
Epoch: [0]  [  960/29316]  eta: 3:11:26  lr: 0.019221  loss: 6.1231 (724.9976)  bbox_ctrness: 0.6766 (0.6769)  bbox_regression: 0.5447 (0.5574)  classification: 4.8785 (723.7633)  time: 0.4063  data: 0.0089  max mem: 2544
Epoch: [0]  [  980/29316]  eta: 3:11:15  lr: 0.019620  loss: 6.1863 (710.3561)  bbox_ctrness: 0.6761 (0.6769)  bbox_regression: 0.5546 (0.5576)  classification: 4.9795 (709.1216)  time: 0.4001  data: 0.0093  max mem: 2544
Epoch: [0]  [ 1000/29316]  eta: 3:11:06  lr: 0.020000  loss: 7.3203 (696.3108)  bbox_ctrness: 0.6721 (0.6769)  bbox_regression: 0.5377 (0.5574)  classification: 6.0649 (695.0765)  time: 0.4040  data: 0.0089  max mem: 2544
Epoch: [0]  [ 1020/29316]  eta: 3:11:01  lr: 0.020000  loss: 6.1156 (682.7952)  bbox_ctrness: 0.6750 (0.6769)  bbox_regression: 0.5634 (0.5574)  classification: 4.9115 (681.5609)  time: 0.4101  data: 0.0091  max mem: 2561
Epoch: [0]  [ 1040/29316]  eta: 3:10:52  lr: 0.020000  loss: 6.7624 (669.8034)  bbox_ctrness: 0.6791 (0.6771)  bbox_regression: 0.5392 (0.5573)  classification: 5.4573 (668.5689)  time: 0.4023  data: 0.0085  max mem: 2561
Epoch: [0]  [ 1060/29316]  eta: 3:10:45  lr: 0.020000  loss: 6.4302 (657.2999)  bbox_ctrness: 0.6831 (0.6774)  bbox_regression: 0.5756 (0.5575)  classification: 5.1361 (656.0650)  time: 0.4082  data: 0.0088  max mem: 2561
Epoch: [0]  [ 1080/29316]  eta: 3:10:37  lr: 0.020000  loss: 4.7824 (645.2496)  bbox_ctrness: 0.6649 (0.6772)  bbox_regression: 0.5428 (0.5573)  classification: 3.5240 (644.0151)  time: 0.4049  data: 0.0090  max mem: 2561
Epoch: [0]  [ 1100/29316]  eta: 3:10:30  lr: 0.020000  loss: 5.9003 (633.6347)  bbox_ctrness: 0.6621 (0.6771)  bbox_regression: 0.5063 (0.5569)  classification: 4.5515 (632.4007)  time: 0.4064  data: 0.0097  max mem: 2561
Epoch: [0]  [ 1120/29316]  eta: 3:10:19  lr: 0.020000  loss: 5.7935 (622.4408)  bbox_ctrness: 0.6727 (0.6770)  bbox_regression: 0.5657 (0.5567)  classification: 4.5247 (621.2070)  time: 0.4004  data: 0.0091  max mem: 2561
Epoch: [0]  [ 1140/29316]  eta: 3:10:11  lr: 0.020000  loss: 6.5578 (611.6484)  bbox_ctrness: 0.6819 (0.6771)  bbox_regression: 0.5577 (0.5570)  classification: 5.2619 (610.4142)  time: 0.4056  data: 0.0092  max mem: 2561
Epoch: [0]  [ 1160/29316]  eta: 3:09:59  lr: 0.020000  loss: 6.2652 (601.2286)  bbox_ctrness: 0.6708 (0.6770)  bbox_regression: 0.5562 (0.5572)  classification: 5.0248 (599.9944)  time: 0.3963  data: 0.0092  max mem: 2561
Epoch: [0]  [ 1180/29316]  eta: 3:09:45  lr: 0.020000  loss: 6.0045 (591.1511)  bbox_ctrness: 0.6724 (0.6769)  bbox_regression: 0.5483 (0.5573)  classification: 4.8410 (589.9169)  time: 0.3931  data: 0.0094  max mem: 2561
Epoch: [0]  [ 1200/29316]  eta: 3:09:37  lr: 0.020000  loss: 6.9065 (581.4174)  bbox_ctrness: 0.6732 (0.6769)  bbox_regression: 0.5493 (0.5573)  classification: 5.7050 (580.1832)  time: 0.4040  data: 0.0096  max mem: 2561
(pytorch_d_1_13_1_cuda_11_7) $ 

